<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My-Office HRD - Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .fade-out {
            animation: fadeOut 0.3s ease-out 2s forwards;
        }
        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(100%); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <div class="h-10 w-10 bg-blue-600 rounded-full flex items-center justify-center">
                            <svg class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h1 class="text-xl font-bold text-gray-900">My-Office</h1>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="loginBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                        Login
                    </button>
                    <div id="userInfo" class="hidden flex items-center space-x-2">
                        <span id="userName" class="text-sm text-gray-700"></span>
                        <button id="logoutBtn" class="text-red-600 hover:text-red-800 text-sm">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
        <!-- Header -->
        <header class="bg-white shadow">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-gray-900">MyOffice</h1>
                    <div id="loginPrompt" class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md">
                        <p class="text-yellow-800">Silakan login terlebih dahulu untuk mengakses fitur lengkap</p>
                        <p class="text-sm text-yellow-600 mt-1">Demo: admin / admin123</p>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
            <!-- Menu Navigation -->
            <div id="menuSection" class="hidden mb-8">
                <div class="bg-white shadow rounded-lg p-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">Menu Utama</h2>
                    <!-- Sidebar Menu -->
                    <div class="flex">
                        <!-- Sidebar -->
                        <div class="w-64 bg-white shadow-lg h-screen fixed left-0 top-20 z-10 hidden lg:block">
                            <nav class="mt-8">
                                <div class="px-4">
                                    <button id="dashboardBtn" class="menu-btn w-full flex items-center px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700 rounded-lg transition duration-200 mb-2">
                                        <svg class="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z" />
                                        </svg>
                                        Dashboard
                                    </button>

                                    <!-- Employee Management Submenu -->
                                    <div class="mb-4">
                                        <div class="flex items-center px-4 py-2 text-gray-600 font-medium text-sm uppercase tracking-wide">
                                            <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
                                            </svg>
                                            Manajemen Karyawan
                                        </div>
                                        <div class="ml-6 space-y-1">
                                            <button id="employeePersonalBtn" class="menu-btn w-full flex items-center px-4 py-2 text-sm text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg transition duration-200">
                                                <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                                </svg>
                                                Data Pribadi
                                            </button>
                                            <button id="employeeSkillsBtn" class="menu-btn w-full flex items-center px-4 py-2 text-sm text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg transition duration-200">
                                                <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                                </svg>
                                                Keterampilan
                                            </button>
                                        </div>
                                    </div>

                                    <button id="attendanceBtn" class="menu-btn w-full flex items-center px-4 py-3 text-gray-700 hover:bg-yellow-50 hover:text-yellow-700 rounded-lg transition duration-200 mb-2">
                                        <svg class="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                        </svg>
                                        Absensi
                                    </button>

                                    <button id="salaryBtn" class="menu-btn w-full flex items-center px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-lg transition duration-200 mb-2">
                                        <svg class="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                                        </svg>
                                        Gaji
                                    </button>

                                    <button id="performanceBtn" class="menu-btn w-full flex items-center px-4 py-3 text-gray-700 hover:bg-indigo-50 hover:text-indigo-700 rounded-lg transition duration-200 mb-2">
                                        <svg class="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                        </svg>
                                        Performansi
                                    </button>

                                    <button id="settingsBtn" class="menu-btn w-full flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-gray-900 rounded-lg transition duration-200">
                                        <svg class="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                        </svg>
                                        Pengaturan
                                    </button>
                                </div>
                            </nav>
                        </div>

                        <!-- Mobile Menu Toggle -->
                        <div class="lg:hidden w-full">
                            <button id="mobileMenuToggle" class="w-full bg-white shadow p-4 rounded-lg mb-4 flex items-center justify-between">
                                <span class="text-lg font-semibold text-gray-900">Menu Navigasi</span>
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                                </svg>
                            </button>

                            <div id="mobileMenu" class="hidden bg-white shadow rounded-lg p-4 mb-4">
                                <div class="grid grid-cols-2 gap-3">
                                    <button id="dashboardBtnMobile" class="menu-btn bg-blue-50 border border-blue-200 text-blue-700 px-3 py-2 rounded-lg hover:bg-blue-100 transition duration-200 text-sm">
                                        Dashboard
                                    </button>
                                    <button id="employeePersonalBtnMobile" class="menu-btn bg-green-50 border border-green-200 text-green-700 px-3 py-2 rounded-lg hover:bg-green-100 transition duration-200 text-sm">
                                        Data Pribadi
                                    </button>
                                    <button id="employeeSkillsBtnMobile" class="menu-btn bg-green-50 border border-green-200 text-green-700 px-3 py-2 rounded-lg hover:bg-green-100 transition duration-200 text-sm">
                                        Keterampilan
                                    </button>
                                    <button id="attendanceBtnMobile" class="menu-btn bg-yellow-50 border border-yellow-200 text-yellow-700 px-3 py-2 rounded-lg hover:bg-yellow-100 transition duration-200 text-sm">
                                        Absensi
                                    </button>
                                    <button id="salaryBtnMobile" class="menu-btn bg-purple-50 border border-purple-200 text-purple-700 px-3 py-2 rounded-lg hover:bg-purple-100 transition duration-200 text-sm">
                                        Gaji
                                    </button>
                                    <button id="performanceBtnMobile" class="menu-btn bg-indigo-50 border border-indigo-200 text-indigo-700 px-3 py-2 rounded-lg hover:bg-indigo-100 transition duration-200 text-sm">
                                        Performansi
                                    </button>
                                    <button id="settingsBtnMobile" class="menu-btn bg-gray-50 border border-gray-200 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-100 transition duration-200 text-sm col-span-2">
                                        Pengaturan
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Main Content Area -->
                        <div class="lg:ml-64 w-full">
                            <div id="contentArea" class="bg-white shadow rounded-lg p-6">
                                <div id="dashboardContent" class="content-section">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Dashboard</h2>
                                    <p class="text-gray-600">Selamat datang di MyOffice! Pilih menu di sidebar untuk mulai mengelola data karyawan.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Overview -->
            <div id="dashboardSection" class="px-4 py-6 sm:px-0">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">Dashboard HRD</h2>
                    <p class="text-lg text-gray-600">Ringkasan lengkap sistem manajemen sumber daya manusia</p>
                </div>

                <!-- Statistics Cards -->
                <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8">
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Total Karyawan</dt>
                                        <dd class="text-lg font-medium text-gray-900">10</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-green-500 rounded-md flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Karyawan Aktif</dt>
                                        <dd class="text-lg font-medium text-gray-900">9</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Absensi Hari Ini</dt>
                                        <dd class="text-lg font-medium text-gray-900">7</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Slip Gaji</dt>
                                        <dd class="text-lg font-medium text-gray-900">2</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="bg-white shadow rounded-lg p-6 mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Absensi Harian Karyawan (7 Hari Terakhir)</h3>
                    <canvas id="attendanceChart" width="400" height="200"></canvas>
                </div>

                <!-- Features Overview -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <button id="employeeFeatureBtn" class="bg-white overflow-hidden shadow rounded-lg p-6 hover:shadow-lg transition duration-200 text-left">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-blue-500 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Manajemen Karyawan</h3>
                                <p class="text-sm text-gray-500">Tambah, edit, hapus data karyawan</p>
                            </div>
                        </div>
                    </button>

                    <button id="attendanceFeatureBtn" class="bg-white overflow-hidden shadow rounded-lg p-6 hover:shadow-lg transition duration-200 text-left">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-green-500 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Sistem Absensi</h3>
                                <p class="text-sm text-gray-500">Check-in/check-out dengan notifikasi</p>
                            </div>
                        </div>
                    </button>

                    <button id="salaryFeatureBtn" class="bg-white overflow-hidden shadow rounded-lg p-6 hover:shadow-lg transition duration-200 text-left">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-purple-500 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Manajemen Gaji</h3>
                                <p class="text-sm text-gray-500">Generate slip gaji otomatis</p>
                            </div>
                        </div>
                    </button>

                    <button id="performanceFeatureBtn" class="bg-white overflow-hidden shadow rounded-lg p-6 hover:shadow-lg transition duration-200 text-left">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-indigo-500 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Performansi</h3>
                                <p class="text-sm text-gray-500">Evaluasi dan penilaian karyawan</p>
                            </div>
                        </div>
                    </button>
                </div>

                <!-- Sample Data -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <h3 class="text-lg font-medium text-gray-900">Data Karyawan</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NIP</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Posisi</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Departemen</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">John Doe</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024001</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Manager HR</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Human Resources</td>
                                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Jane Smith</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024002</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Developer</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">IT</td>
                                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Bob Johnson</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024003</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Designer</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Design</td>
                                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Alice Brown</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024004</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Marketing Manager</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Marketing</td>
                                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Charlie Wilson</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024005</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Accountant</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Finance</td>
                                    <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aktif</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>

        <!-- Modals -->
        <!-- Login Modal -->
        <div id="loginModal" class="modal-overlay hidden">
            <div class="modal-content max-w-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Login ke My-Office</h3>
                    <button id="closeLoginModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="loginForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                        <input type="text" id="loginUsername" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Masukkan username" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Masukkan password" required>
                    </div>
                    <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md">
                        <p class="text-sm text-blue-800"><strong>Demo Credentials:</strong></p>
                        <p class="text-sm text-blue-700">Username: admin<br>Password: admin123</p>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">
                        Login
                    </button>
                </form>
            </div>
        </div>

        <!-- Employee Management Modal -->
        <div id="employeeModal" class="modal-overlay hidden">
            <div class="modal-content max-w-6xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">Manajemen Karyawan</h3>
                    <button id="closeEmployeeModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="mb-4 flex justify-between items-center">
                    <button id="addEmployeeBtn" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200">
                        + Tambah Karyawan
                    </button>
                    <div class="flex space-x-2">
                        <input type="text" id="searchEmployee" placeholder="Cari karyawan..." class="px-3 py-2 border border-gray-300 rounded-md text-sm">
                        <select id="filterDepartment" class="px-3 py-2 border border-gray-300 rounded-md text-sm">
                            <option value="">Semua Departemen</option>
                            <option value="Human Resources">Human Resources</option>
                            <option value="IT">IT</option>
                            <option value="Design">Design</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Finance">Finance</option>
                            <option value="Sales">Sales</option>
                            <option value="Operations">Operations</option>
                        </select>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 border border-gray-300 text-left">NIP</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Nama</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Email</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Posisi</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Departemen</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Gaji</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Status</th>
                                <th class="px-4 py-2 border border-gray-300 text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTableBody">
                            <!-- Employee data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Add/Edit Employee Form Modal -->
        <div id="employeeFormModal" class="modal-overlay hidden">
            <div class="modal-content max-w-2xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 id="employeeFormTitle" class="text-xl font-semibold text-gray-900">Tambah Karyawan Baru</h3>
                    <button id="closeEmployeeFormModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <form id="employeeForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">NIP *</label>
                            <input type="text" id="empNip" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: 2024001">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap *</label>
                            <input type="text" id="empName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                            <input type="email" id="empEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nomor Telepon *</label>
                            <input type="tel" id="empPhone" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Alamat Lengkap *</label>
                            <textarea id="empAddress" required rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Jl. Contoh No. 123, Kelurahan, Kecamatan, Kota, Kode Pos"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Posisi *</label>
                            <input type="text" id="empPosition" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Departemen *</label>
                            <select id="empDepartment" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Pilih Departemen</option>
                                <option value="Human Resources">Human Resources</option>
                                <option value="IT">IT</option>
                                <option value="Design">Design</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Finance">Finance</option>
                                <option value="Sales">Sales</option>
                                <option value="Operations">Operations</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Lahir *</label>
                            <input type="date" id="empBirthDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Bergabung *</label>
                            <input type="date" id="empJoinDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nomor Rekening Bank *</label>
                            <input type="text" id="empBankAccount" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: 1234567890">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Bank *</label>
                            <select id="empBankName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Pilih Bank</option>
                                <option value="BCA">BCA</option>
                                <option value="Mandiri">Mandiri</option>
                                <option value="BRI">BRI</option>
                                <option value="BNI">BNI</option>
                                <option value="CIMB Niaga">CIMB Niaga</option>
                                <option value="Danamon">Danamon</option>
                                <option value="Permata">Permata</option>
                                <option value="BSI">BSI</option>
                                <option value="OCBC NISP">OCBC NISP</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">NPWP *</label>
                            <input type="text" id="empNpwp" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: 12.345.678.9-012.345">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Gaji Pokok (Rp) *</label>
                            <input type="number" id="empSalary" required min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="empStatus" value="active" checked class="mr-2">
                                <span class="text-sm">Aktif</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="empStatus" value="inactive" class="mr-2">
                                <span class="text-sm">Tidak Aktif</span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4 border-t">
                        <button type="button" id="cancelEmployeeForm" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 transition duration-200">
                            Batal
                        </button>
                        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                            Simpan
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Attendance Modal -->
        <div id="attendanceModal" class="modal-overlay hidden">
            <div class="modal-content max-w-4xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">Sistem Absensi</h3>
                    <button id="closeAttendanceModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Check-in/Check-out Hari Ini</h4>
                        <select id="employeeSelect" class="w-full mb-4 px-3 py-2 border border-gray-300 rounded-md">
                            <option value="">Pilih Karyawan</option>
                        </select>
                        <div class="flex space-x-2">
                            <button id="checkInBtn" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:bg-gray-400" disabled>
                                Check-in
                            </button>
                            <button id="checkOutBtn" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:bg-gray-400" disabled>
                                Check-out
                            </button>
                        </div>
                        <div id="attendanceStatus" class="mt-4 text-sm text-gray-600"></div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Laporan Absensi</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Total Karyawan:</span>
                                <span id="totalEmployees">10</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Hadir Hari Ini:</span>
                                <span id="presentToday">7</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Tidak Hadir:</span>
                                <span id="absentToday">3</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 border border-gray-300 text-left">Karyawan</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Tanggal</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Check-in</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Check-out</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Status</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <!-- Attendance data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Salary Modal -->
        <div id="salaryModal" class="modal-overlay hidden">
            <div class="modal-content max-w-4xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">Manajemen Gaji</h3>
                    <button id="closeSalaryModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="mb-4">
                    <button id="generateSalaryBtn" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition duration-200">
                        Generate Slip Gaji
                    </button>
                </div>

                <div class="mb-4 flex justify-between items-center">
                    <button id="generateSalaryBtn" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition duration-200">
                        Generate Slip Gaji
                    </button>
                    <div class="flex space-x-2">
                        <button id="exportSalaryPDF" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition duration-200">
                            Export PDF
                        </button>
                        <button id="exportSalaryXLSX" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200">
                            Export XLSX
                        </button>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 border border-gray-300 text-left">Karyawan</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Periode</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Gaji Pokok</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Tunjangan</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Potongan</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Gaji Bersih</th>
                                <th class="px-4 py-2 border border-gray-300 text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="salaryTableBody">
                            <!-- Salary data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Performance Modal -->
        <div id="performanceModal" class="modal-overlay hidden">
            <div class="modal-content max-w-6xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">Evaluasi Performansi Karyawan</h3>
                    <button id="closePerformanceModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="mb-4 flex justify-between items-center">
                    <button id="addEvaluationBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition duration-200">
                        + Tambah Evaluasi
                    </button>
                    <div class="flex space-x-2">
                        <button id="exportPerformancePDF" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition duration-200">
                            Export PDF
                        </button>
                        <button id="exportPerformanceXLSX" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200">
                            Export XLSX
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Ringkasan Performansi</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Rata-rata Skor:</span>
                                <span id="avgScore" class="font-semibold">85%</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Karyawan Excellent:</span>
                                <span id="excellentCount">3</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Perlu Perbaikan:</span>
                                <span id="needsImprovement">2</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Kriteria Penilaian</h4>
                        <ul class="text-sm space-y-1">
                            <li> Produktivitas (25%)</li>
                            <li> Kualitas Kerja (25%)</li>
                            <li> Kerjasama Tim (20%)</li>
                            <li> Kedisiplinan (15%)</li>
                            <li> Inisiatif (15%)</li>
                        </ul>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 border border-gray-300 text-left">Karyawan</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Departemen</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Periode</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Skor Total</th>
                                <th class="px-4 py-2 border border-gray-300 text-left">Kategori</th>
                                <th class="px-4 py-2 border border-gray-300 text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="performanceTableBody">
                            <!-- Performance data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Performance Evaluation Form Modal -->
        <div id="performanceFormModal" class="modal-overlay hidden">
            <div class="modal-content max-w-5xl max-h-screen overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h3 id="performanceFormTitle" class="text-xl font-semibold text-gray-900">Form Evaluasi Performansi Karyawan</h3>
                    <button id="closePerformanceFormModal" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <form id="performanceForm" class="space-y-6">
                    <!-- Informasi Dasar -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Informasi Dasar</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nama Karyawan *</label>
                                <select id="perfEmployee" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Pilih Karyawan</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">NIP</label>
                                <input type="text" id="perfNip" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Jabatan</label>
                                <input type="text" id="perfPosition" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Departemen</label>
                                <input type="text" id="perfDepartment" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Periode Evaluasi *</label>
                                <select id="perfPeriod" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Pilih Periode</option>
                                    <option value="Q1 2024">Q1 2024 (Jan-Mar)</option>
                                    <option value="Q2 2024">Q2 2024 (Apr-Jun)</option>
                                    <option value="Q3 2024">Q3 2024 (Jul-Sep)</option>
                                    <option value="Q4 2024">Q4 2024 (Oct-Dec)</option>
                                    <option value="Januari 2024">Januari 2024</option>
                                    <option value="Februari 2024">Februari 2024</option>
                                    <option value="Semester 1 2024">Semester 1 2024</option>
                                    <option value="Semester 2 2024">Semester 2 2024</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Evaluasi *</label>
                                <input type="date" id="perfDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nama Evaluator *</label>
                                <select id="perfEvaluator" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Pilih Evaluator</option>
                                    <option value="John Doe">John Doe - Manager HR</option>
                                    <option value="Jane Smith">Jane Smith - Senior Developer</option>
                                    <option value="Bob Johnson">Bob Johnson - Project Manager</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Penilaian Kriteria Utama -->
                    <div class="bg-white border border-gray-200 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Penilaian Kriteria Utama</h4>

                        <!-- Produktivitas -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700">1. Produktivitas (Bobot: 25%)</label>
                                <span id="productivityScore" class="text-sm font-semibold text-blue-600">0</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="60" class="mr-2"> <span class="text-xs">1-60 (Kurang)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="70" class="mr-2"> <span class="text-xs">61-70 (Cukup)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="80" class="mr-2"> <span class="text-xs">71-80 (Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="90" class="mr-2"> <span class="text-xs">81-90 (Sangat Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="95" class="mr-2"> <span class="text-xs">91-95 (Excellent)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="productivity" value="100" class="mr-2"> <span class="text-xs">96-100 (Outstanding)</span>
                                </label>
                            </div>
                            <textarea id="productivityNotes" placeholder="Catatan produktivitas..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- Kualitas Kerja -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700">2. Kualitas Kerja (Bobot: 25%)</label>
                                <span id="qualityScore" class="text-sm font-semibold text-blue-600">0</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="60" class="mr-2"> <span class="text-xs">1-60 (Kurang)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="70" class="mr-2"> <span class="text-xs">61-70 (Cukup)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="80" class="mr-2"> <span class="text-xs">71-80 (Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="90" class="mr-2"> <span class="text-xs">81-90 (Sangat Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="95" class="mr-2"> <span class="text-xs">91-95 (Excellent)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="quality" value="100" class="mr-2"> <span class="text-xs">96-100 (Outstanding)</span>
                                </label>
                            </div>
                            <textarea id="qualityNotes" placeholder="Catatan kualitas kerja..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- Kerjasama Tim -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700">3. Kerjasama Tim (Bobot: 20%)</label>
                                <span id="teamworkScore" class="text-sm font-semibold text-blue-600">0</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="60" class="mr-2"> <span class="text-xs">1-60 (Kurang)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="70" class="mr-2"> <span class="text-xs">61-70 (Cukup)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="80" class="mr-2"> <span class="text-xs">71-80 (Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="90" class="mr-2"> <span class="text-xs">81-90 (Sangat Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="95" class="mr-2"> <span class="text-xs">91-95 (Excellent)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="teamwork" value="100" class="mr-2"> <span class="text-xs">96-100 (Outstanding)</span>
                                </label>
                            </div>
                            <textarea id="teamworkNotes" placeholder="Catatan kerjasama tim..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- Kedisiplinan -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700">4. Kedisiplinan (Bobot: 15%)</label>
                                <span id="disciplineScore" class="text-sm font-semibold text-blue-600">0</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="60" class="mr-2"> <span class="text-xs">1-60 (Kurang)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="70" class="mr-2"> <span class="text-xs">61-70 (Cukup)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="80" class="mr-2"> <span class="text-xs">71-80 (Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="90" class="mr-2"> <span class="text-xs">81-90 (Sangat Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="95" class="mr-2"> <span class="text-xs">91-95 (Excellent)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="discipline" value="100" class="mr-2"> <span class="text-xs">96-100 (Outstanding)</span>
                                </label>
                            </div>
                            <textarea id="disciplineNotes" placeholder="Catatan kedisiplinan..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- Inisiatif -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700">5. Inisiatif & Pengembangan (Bobot: 15%)</label>
                                <span id="initiativeScore" class="text-sm font-semibold text-blue-600">0</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="60" class="mr-2"> <span class="text-xs">1-60 (Kurang)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="70" class="mr-2"> <span class="text-xs">61-70 (Cukup)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="80" class="mr-2"> <span class="text-xs">71-80 (Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="90" class="mr-2"> <span class="text-xs">81-90 (Sangat Baik)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="95" class="mr-2"> <span class="text-xs">91-95 (Excellent)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="initiative" value="100" class="mr-2"> <span class="text-xs">96-100 (Outstanding)</span>
                                </label>
                            </div>
                            <textarea id="initiativeNotes" placeholder="Catatan inisiatif dan pengembangan..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- Skor Total -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-gray-900">SKOR TOTAL:</span>
                                <span id="totalScore" class="text-2xl font-bold text-blue-600">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-gray-700">KATEGORI:</span>
                                <span id="performanceCategory" class="px-3 py-1 text-sm font-semibold rounded-full bg-gray-100 text-gray-800">Belum Dinilai</span>
                            </div>
                        </div>
                    </div>

                    <!-- Feedback & Catatan -->
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Feedback & Catatan</h4>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Kelebihan (Strengths)</label>
                                <textarea id="strengths" rows="4" placeholder="Sebutkan poin-poin positif karyawan..." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Area Perbaikan</label>
                                <textarea id="improvements" rows="4" placeholder="Sebutkan area yang perlu diperbaiki..." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tujuan Pengembangan (3-6 Bulan Kedepan)</label>
                            <textarea id="developmentGoals" rows="3" placeholder="Target pengembangan karyawan..." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Catatan Tambahan Evaluator</label>
                            <textarea id="additionalNotes" rows="3" placeholder="Catatan tambahan dari evaluator..." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>
                    </div>

                    <!-- Approval Section -->
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-4">Persetujuan</h4>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="evaluatorApproval" class="mr-2">
                                    <span class="text-sm font-medium text-gray-700">Disetujui Evaluator</span>
                                </label>
                                <input type="text" id="evaluatorSignature" placeholder="Nama lengkap evaluator" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="employeeAcknowledgment" class="mr-2">
                                    <span class="text-sm font-medium text-gray-700">Dibaca & Disetujui Karyawan</span>
                                </label>
                                <input type="text" id="employeeSignature" placeholder="Nama lengkap karyawan" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end space-x-3 pt-4 border-t">
                        <button type="button" id="cancelPerformanceForm" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 transition duration-200">
                            Batal
                        </button>
                        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                            Simpan Evaluasi
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-white border-t border-gray-200 mt-12">
            <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <p class="text-sm text-gray-500">
                        MyOffice made by Hubie 2025
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Notifications -->
    <div id="notification" class="notification hidden">
        <span id="notificationText"></span>
    </div>

    <script>
        // Global state
        let currentUser = null;
        let employees = [
            { id: 1, nip: '2024001', name: 'John Doe', email: 'john.doe@company.com', position: 'Manager HR', department: 'Human Resources', phone: '+62-812-3456-7890', address: 'Jl. Sudirman No. 123, Jakarta Pusat, DKI Jakarta 10230', birthDate: '1985-05-20', joinDate: '2020-01-15', bankAccount: '1234567890', bankName: 'BCA', npwp: '12.345.678.9-012.345', status: 'active', salary: 8000000 },
            { id: 2, nip: '2024002', name: 'Jane Smith', email: 'jane.smith@company.com', position: 'Developer', department: 'IT', phone: '+62-811-2345-6789', address: 'Jl. Thamrin No. 456, Jakarta Selatan, DKI Jakarta 12190', birthDate: '1990-08-15', joinDate: '2021-03-10', bankAccount: '2345678901', bankName: 'Mandiri', npwp: '23.456.789.0-123.456', status: 'active', salary: 7000000 },
            { id: 3, nip: '2024003', name: 'Bob Johnson', email: 'bob.johnson@company.com', position: 'Designer', department: 'Design', phone: '+62-813-4567-8901', address: 'Jl. Gatot Subroto No. 789, Jakarta Selatan, DKI Jakarta 12930', birthDate: '1988-12-03', joinDate: '2021-06-01', bankAccount: '3456789012', bankName: 'BRI', npwp: '34.567.890.1-234.567', status: 'active', salary: 6500000 },
            { id: 4, nip: '2024004', name: 'Alice Brown', email: 'alice.brown@company.com', position: 'Marketing Manager', department: 'Marketing', phone: '+62-814-5678-9012', address: 'Jl. MH Thamrin No. 101, Jakarta Pusat, DKI Jakarta 10310', birthDate: '1982-04-12', joinDate: '2019-11-20', bankAccount: '4567890123', bankName: 'BNI', npwp: '45.678.901.2-345.678', status: 'active', salary: 7500000 },
            { id: 5, nip: '2024005', name: 'Charlie Wilson', email: 'charlie.wilson@company.com', position: 'Accountant', department: 'Finance', phone: '+62-815-6789-0123', address: 'Jl. Jenderal Sudirman No. 202, Jakarta Pusat, DKI Jakarta 10220', birthDate: '1992-07-25', joinDate: '2022-01-05', bankAccount: '5678901234', bankName: 'CIMB Niaga', npwp: '56.789.012.3-456.789', status: 'active', salary: 6000000 },
            { id: 6, nip: '2024006', name: 'Diana Davis', email: 'diana.davis@company.com', position: 'Sales Representative', department: 'Sales', phone: '+62-816-7890-1234', address: 'Jl. Rasuna Said No. 303, Jakarta Selatan, DKI Jakarta 12960', birthDate: '1995-09-18', joinDate: '2022-04-15', bankAccount: '6789012345', bankName: 'Danamon', npwp: '67.890.123.4-567.890', status: 'active', salary: 5500000 },
            { id: 7, nip: '2024007', name: 'Edward Miller', email: 'edward.miller@company.com', position: 'Project Manager', department: 'Operations', phone: '+62-817-8901-2345', address: 'Jl. HR Rasuna Said No. 404, Jakarta Selatan, DKI Jakarta 12940', birthDate: '1987-11-08', joinDate: '2020-09-30', bankAccount: '7890123456', bankName: 'Permata', npwp: '78.901.234.5-678.901', status: 'active', salary: 8500000 },
            { id: 8, nip: '2024008', name: 'Fiona Garcia', email: 'fiona.garcia@company.com', position: 'HR Assistant', department: 'Human Resources', phone: '+62-818-9012-3456', address: 'Jl. Kuningan No. 505, Jakarta Selatan, DKI Jakarta 12980', birthDate: '1993-02-28', joinDate: '2023-01-10', bankAccount: '8901234567', bankName: 'BSI', npwp: '89.012.345.6-789.012', status: 'active', salary: 5000000 },
            { id: 9, nip: '2024009', name: 'George Taylor', email: 'george.taylor@company.com', position: 'IT Support', department: 'IT', phone: '+62-819-0123-4567', address: 'Jl. Casablanca No. 606, Jakarta Selatan, DKI Jakarta 12870', birthDate: '1991-06-14', joinDate: '2023-03-20', bankAccount: '9012345678', bankName: 'OCBC NISP', npwp: '90.123.456.7-890.123', status: 'active', salary: 5500000 },
            { id: 10, nip: '2024010', name: 'Helen Anderson', email: 'helen.anderson@company.com', position: 'Content Writer', department: 'Marketing', phone: '+62-820-1234-5678', address: 'Jl. Senopati No. 707, Jakarta Selatan, DKI Jakarta 12190', birthDate: '1994-10-30', joinDate: '2022-08-05', bankAccount: '0123456789', bankName: 'BCA', npwp: '01.234.567.8-901.234', status: 'active', salary: 5200000 }
        ];

        let attendance = [];
        let salaries = [];
        let performance = [];

        // Initialize attendance data
        const today = new Date().toISOString().split('T')[0];
        employees.slice(0, 7).forEach(emp => {
            attendance.push({
                id: Date.now() + Math.random(),
                employeeId: emp.id,
                employeeName: emp.name,
                date: today,
                checkIn: '08:30',
                checkOut: '17:30',
                status: 'present'
            });
        });

        // Initialize salary data
        employees.forEach(emp => {
            salaries.push({
                id: Date.now() + Math.random(),
                employeeId: emp.id,
                employeeName: emp.name,
                period: 'Januari 2024',
                baseSalary: emp.salary,
                allowances: emp.salary * 0.1,
                netSalary: emp.salary * 1.1
            });
        });

        // Initialize performance data
        employees.forEach(emp => {
            const score = Math.floor(Math.random() * 40) + 60; // 60-100
            performance.push({
                id: Date.now() + Math.random(),
                employeeId: emp.id,
                employeeName: emp.name,
                period: 'Q4 2024',
                totalScore: score,
                category: score >= 90 ? 'Excellent' : score >= 80 ? 'Good' : score >= 70 ? 'Average' : 'Needs Improvement'
            });
        });

        // Chart.js initialization - Smooth Line Chart for Attendance
        const ctx = document.getElementById('attendanceChart').getContext('2d');
        const attendanceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu'],
                datasets: [{
                    label: 'Jumlah Karyawan Hadir',
                    data: [8, 9, 7, 8, 9, 6, 5],
                    borderColor: 'rgba(59, 130, 246, 1)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    title: {
                        display: true,
                        text: 'Tren Absensi Harian (7 Hari Terakhir)',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10,
                        ticks: {
                            stepSize: 1
                        }
                    }
                },
                elements: {
                    point: {
                        hoverBorderWidth: 3
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                }
            }
        });

        // Event Listeners
        document.getElementById('loginBtn').addEventListener('click', () => {
            document.getElementById('loginModal').classList.remove('hidden');
        });

        document.getElementById('closeLoginModal').addEventListener('click', () => {
            document.getElementById('loginModal').classList.add('hidden');
        });

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (username === 'admin' && password === 'admin123') {
                currentUser = { username: 'admin', role: 'admin' };
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('userName').textContent = currentUser.username;
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('loginPrompt').classList.add('hidden');
                document.getElementById('menuSection').classList.remove('hidden');
                showNotification('Login berhasil! Selamat datang di My-Office.', 'success');
            } else {
                alert('Username atau password salah!');
            }
        });

        document.getElementById('logoutBtn').addEventListener('click', () => {
            currentUser = null;
            document.getElementById('loginBtn').classList.remove('hidden');
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('loginPrompt').classList.remove('hidden');
            document.getElementById('menuSection').classList.add('hidden');
            showNotification('Anda telah logout.', 'info');
        });

        // Menu buttons
        document.querySelectorAll('.menu-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (!currentUser) {
                    document.getElementById('loginModal').classList.remove('hidden');
                    return;
                }
                // Remove active class from all buttons
                document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('ring-2', 'ring-blue-500'));
                // Add active class to clicked button
                btn.classList.add('ring-2', 'ring-blue-500');
            });
        });

        // Feature buttons
        document.getElementById('employeeFeatureBtn').addEventListener('click', () => {
            if (!currentUser) {
                document.getElementById('loginModal').classList.remove('hidden');
                return;
            }
            openEmployeeModal();
        });

        document.getElementById('attendanceFeatureBtn').addEventListener('click', () => {
            if (!currentUser) {
                document.getElementById('loginModal').classList.remove('hidden');
                return;
            }
            openAttendanceModal();
        });

        document.getElementById('salaryFeatureBtn').addEventListener('click', () => {
            if (!currentUser) {
                document.getElementById('loginModal').classList.remove('hidden');
                return;
            }
            openSalaryModal();
        });

        document.getElementById('performanceFeatureBtn').addEventListener('click', () => {
            if (!currentUser) {
                document.getElementById('loginModal').classList.remove('hidden');
                return;
            }
            openPerformanceModal();
        });

        // Modal close buttons
        document.getElementById('closeEmployeeModal').addEventListener('click', () => {
            document.getElementById('employeeModal').classList.add('hidden');
        });

        document.getElementById('closeAttendanceModal').addEventListener('click', () => {
            document.getElementById('attendanceModal').classList.add('hidden');
        });

        document.getElementById('closeSalaryModal').addEventListener('click', () => {
            document.getElementById('salaryModal').classList.add('hidden');
        });

        document.getElementById('closePerformanceModal').addEventListener('click', () => {
            document.getElementById('performanceModal').classList.add('hidden');
        });

        // Functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');

            notificationText.textContent = message;
            notification.classList.remove('hidden');

            if (type === 'success') {
                notification.classList.add('bg-green-500');
                notification.classList.remove('bg-red-500', 'bg-blue-500');
            } else if (type === 'error') {
                notification.classList.add('bg-red-500');
                notification.classList.remove('bg-green-500', 'bg-blue-500');
            } else {
                notification.classList.add('bg-blue-500');
                notification.classList.remove('bg-green-500', 'bg-red-500');
            }

            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => {
                    notification.classList.add('hidden');
                    notification.classList.remove('fade-out');
                }, 300);
            }, 2000);
        }

        function openEmployeeModal() {
            const tbody = document.getElementById('employeeTableBody');
            const searchTerm = document.getElementById('searchEmployee').value.toLowerCase();
            const filterDept = document.getElementById('filterDepartment').value;

            tbody.innerHTML = '';

            let filteredEmployees = employees;

            // Apply search filter
            if (searchTerm) {
                filteredEmployees = filteredEmployees.filter(emp =>
                    emp.name.toLowerCase().includes(searchTerm) ||
                    emp.email.toLowerCase().includes(searchTerm) ||
                    emp.position.toLowerCase().includes(searchTerm)
                );
            }

            // Apply department filter
            if (filterDept) {
                filteredEmployees = filteredEmployees.filter(emp => emp.department === filterDept);
            }

            filteredEmployees.forEach(emp => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2 border border-gray-300">${emp.nip || '-'}</td>
                    <td class="px-4 py-2 border border-gray-300">${emp.name}</td>
                    <td class="px-4 py-2 border border-gray-300">${emp.email || '-'}</td>
                    <td class="px-4 py-2 border border-gray-300">${emp.position}</td>
                    <td class="px-4 py-2 border border-gray-300">${emp.department}</td>
                    <td class="px-4 py-2 border border-gray-300">Rp ${emp.salary ? emp.salary.toLocaleString() : '0'}</td>
                    <td class="px-4 py-2 border border-gray-300">
                        <span class="px-2 py-1 text-xs rounded-full ${emp.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${emp.status === 'active' ? 'Aktif' : 'Tidak Aktif'}
                        </span>
                    </td>
                    <td class="px-4 py-2 border border-gray-300 text-center">
                        <button class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 mr-1" onclick="editEmployee(${emp.id})">Edit</button>
                        <button class="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600" onclick="deleteEmployee(${emp.id})">Hapus</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('employeeModal').classList.remove('hidden');
        }

        function openAttendanceModal() {
            const tbody = document.getElementById('attendanceTableBody');
            const employeeSelect = document.getElementById('employeeSelect');

            // Populate employee select
            employeeSelect.innerHTML = '<option value="">Pilih Karyawan</option>';
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                employeeSelect.appendChild(option);
            });

            // Populate attendance table
            tbody.innerHTML = '';
            attendance.forEach(att => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2 border border-gray-300">${att.employeeName}</td>
                    <td class="px-4 py-2 border border-gray-300">${att.date}</td>
                    <td class="px-4 py-2 border border-gray-300">${att.checkIn || '-'}</td>
                    <td class="px-4 py-2 border border-gray-300">${att.checkOut || '-'}</td>
                    <td class="px-4 py-2 border border-gray-300">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">${att.status}</span>
                    </td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('attendanceModal').classList.remove('hidden');
        }

        function openSalaryModal() {
            const tbody = document.getElementById('salaryTableBody');
            tbody.innerHTML = '';

            salaries.forEach(sal => {
                const deductions = sal.baseSalary * 0.05; // 5% potongan
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2 border border-gray-300">${sal.employeeName}</td>
                    <td class="px-4 py-2 border border-gray-300">${sal.period}</td>
                    <td class="px-4 py-2 border border-gray-300">Rp ${sal.baseSalary.toLocaleString()}</td>
                    <td class="px-4 py-2 border border-gray-300">Rp ${sal.allowances.toLocaleString()}</td>
                    <td class="px-4 py-2 border border-gray-300">Rp ${deductions.toLocaleString()}</td>
                    <td class="px-4 py-2 border border-gray-300 font-semibold">Rp ${sal.netSalary.toLocaleString()}</td>
                    <td class="px-4 py-2 border border-gray-300 text-center">
                        <button class="bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 mr-1" onclick="exportSalary(${sal.id})">Export</button>
                        <button class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600" onclick="viewSalaryDetail(${sal.id})">Detail</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('salaryModal').classList.remove('hidden');
        }

        function openPerformanceModal() {
            const tbody = document.getElementById('performanceTableBody');
            tbody.innerHTML = '';

            performance.forEach(perf => {
                const employee = employees.find(e => e.name === perf.employeeName);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2 border border-gray-300">${perf.employeeName}</td>
                    <td class="px-4 py-2 border border-gray-300">${employee?.department || '-'}</td>
                    <td class="px-4 py-2 border border-gray-300">${perf.period}</td>
                    <td class="px-4 py-2 border border-gray-300 font-semibold">${perf.totalScore}%</td>
                    <td class="px-4 py-2 border border-gray-300">
                        <span class="px-2 py-1 text-xs rounded-full ${
                            perf.category === 'Excellent' ? 'bg-green-100 text-green-800' :
                            perf.category === 'Good' ? 'bg-blue-100 text-blue-800' :
                            perf.category === 'Average' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                        }">${perf.category}</span>
                    </td>
                    <td class="px-4 py-2 border border-gray-300 text-center">
                        <button class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 mr-1" onclick="viewPerformance(${perf.id})">Lihat</button>
                        <button class="bg-purple-500 text-white px-2 py-1 rounded text-xs hover:bg-purple-600" onclick="editPerformance(${perf.id})">Edit</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('performanceModal').classList.remove('hidden');
        }

        // Global functions for onclick handlers
        window.editEmployee = function(id) {
            const employee = employees.find(emp => emp.id == id);
            if (employee) {
                document.getElementById('employeeFormTitle').textContent = 'Edit Karyawan';
                document.getElementById('empNip').value = employee.nip || '';
                document.getElementById('empName').value = employee.name;
                document.getElementById('empEmail').value = employee.email || '';
                document.getElementById('empPosition').value = employee.position;
                document.getElementById('empDepartment').value = employee.department;
                document.getElementById('empPhone').value = employee.phone || '';
                document.getElementById('empAddress').value = employee.address || '';
                document.getElementById('empBirthDate').value = employee.birthDate || '';
                document.getElementById('empJoinDate').value = employee.joinDate || '';
                document.getElementById('empBankAccount').value = employee.bankAccount || '';
                document.getElementById('empBankName').value = employee.bankName || '';
                document.getElementById('empNpwp').value = employee.npwp || '';
                document.getElementById('empSalary').value = employee.salary || '';

                const statusRadios = document.getElementsByName('empStatus');
                statusRadios.forEach(radio => {
                    if (radio.value === employee.status) {
                        radio.checked = true;
                    }
                });

                document.getElementById('employeeFormModal').classList.remove('hidden');
                document.getElementById('employeeForm').setAttribute('data-edit-id', id);
            }
        };

        window.deleteEmployee = function(id) {
            if (confirm('Apakah Anda yakin ingin menghapus karyawan ini?')) {
                employees = employees.filter(emp => emp.id != id);
                openEmployeeModal();
                showNotification('Karyawan berhasil dihapus!', 'success');
            }
        };

        window.exportSalary = function(id) {
            const salary = salaries.find(s => s.id === id);
            if (salary) {
                const deductions = salary.baseSalary * 0.05; // 5% potongan
                const employee = employees.find(e => e.name === salary.employeeName);

                const content = `SLIP GAJI KARYAWAN
PT. MY-OFFICE INDONESIA
========================

INFORMASI KARYAWAN
NIP: ${employee?.nip || '-'}
Nama: ${salary.employeeName}
Jabatan: ${employee?.position || '-'}
Departemen: ${employee?.department || '-'}
Periode: ${salary.period}

RINCIAN PENGHASILAN
==================
Gaji Pokok          : Rp ${salary.baseSalary.toLocaleString()}
Tunjangan Transport : Rp ${(salary.allowances * 0.3).toLocaleString()}
Tunjangan Makan     : Rp ${(salary.allowances * 0.4).toLocaleString()}
Tunjangan Jabatan   : Rp ${(salary.allowances * 0.3).toLocaleString()}
Total Tunjangan     : Rp ${salary.allowances.toLocaleString()}

POTONGAN
========
BPJS Kesehatan      : Rp ${(salary.baseSalary * 0.01).toLocaleString()}
BPJS Ketenagakerjaan: Rp ${(salary.baseSalary * 0.02).toLocaleString()}
PPH 21              : Rp ${(salary.baseSalary * 0.02).toLocaleString()}
Total Potongan      : Rp ${deductions.toLocaleString()}

GAJI BERSIH         : Rp ${salary.netSalary.toLocaleString()}

INFORMASI TRANSFER
==================
Bank: ${employee?.bankName || '-'}
No. Rekening: ${employee?.bankAccount || '-'}
Atas Nama: ${salary.employeeName}

Dicetak pada: ${new Date().toLocaleDateString('id-ID')}
PT. MY-OFFICE INDONESIA`;

                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `slip-gaji-${salary.employeeName.replace(' ', '-')}-${salary.period.replace(' ', '-')}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification('Slip gaji berhasil diunduh!', 'success');
            }
        };

        window.viewSalaryDetail = function(id) {
            const salary = salaries.find(s => s.id === id);
            if (salary) {
                const deductions = salary.baseSalary * 0.05;
                const employee = employees.find(e => e.name === salary.employeeName);

                alert(`DETAIL SLIP GAJI

KARYAWAN: ${salary.employeeName}
NIP: ${employee?.nip || '-'}
PERIODE: ${salary.period}

PENGHASILAN:
- Gaji Pokok: Rp ${salary.baseSalary.toLocaleString()}
- Tunjangan Transport: Rp ${(salary.allowances * 0.3).toLocaleString()}
- Tunjangan Makan: Rp ${(salary.allowances * 0.4).toLocaleString()}
- Tunjangan Jabatan: Rp ${(salary.allowances * 0.3).toLocaleString()}
- Total Tunjangan: Rp ${salary.allowances.toLocaleString()}

POTONGAN:
- BPJS Kesehatan: Rp ${(salary.baseSalary * 0.01).toLocaleString()}
- BPJS Ketenagakerjaan: Rp ${(salary.baseSalary * 0.02).toLocaleString()}
- PPH 21: Rp ${(salary.baseSalary * 0.02).toLocaleString()}
- Total Potongan: Rp ${deductions.toLocaleString()}

GAJI BERSIH: Rp ${salary.netSalary.toLocaleString()}

BANK TRANSFER:
${employee?.bankName || '-'} - ${employee?.bankAccount || '-'}
A.n: ${salary.employeeName}`);
            }
        };

        window.viewPerformance = function(id) {
            const perf = performance.find(p => p.id === id);
            if (perf) {
                const details = perf.details || {};
                alert(`EVALUASI PERFORMANSI DETAIL

KARYAWAN: ${perf.employeeName}
PERIODE: ${perf.period}
SKOR TOTAL: ${perf.totalScore}%
KATEGORI: ${perf.category}

KRITERIA PENILAIAN:
 Produktivitas (25%): ${details.productivity || Math.floor(perf.totalScore * 0.25)}%
 Kualitas Kerja (25%): ${details.quality || Math.floor(perf.totalScore * 0.25)}%
 Kerjasama Tim (20%): ${details.teamwork || Math.floor(perf.totalScore * 0.20)}%
 Kedisiplinan (15%): ${details.discipline || Math.floor(perf.totalScore * 0.15)}%
 Inisiatif (15%): ${details.initiative || Math.floor(perf.totalScore * 0.15)}%

KESIMPULAN:
${perf.category === 'Excellent' ? 'Kinerja sangat baik, berikan reward!' :
  perf.category === 'Good' ? 'Kinerja baik, pertahankan!' :
  perf.category === 'Average' ? 'Kinerja cukup, perlu perbaikan!' :
  'Kinerja perlu perbaikan signifikan!'}`);
            }
        };

        window.editPerformance = function(id) {
            const perf = performance.find(p => p.id === id);
            if (perf) {
                document.getElementById('performanceFormTitle').textContent = 'Edit Evaluasi Performansi';
                document.getElementById('performanceFormModal').classList.remove('hidden');

                // Populate form with existing data
                const employee = employees.find(e => e.name === perf.employeeName);
                if (employee) {
                    document.getElementById('perfEmployee').value = employee.id;
                    document.getElementById('perfNip').value = employee.nip || '';
                    document.getElementById('perfPosition').value = employee.position || '';
                    document.getElementById('perfDepartment').value = employee.department || '';
                }

                document.getElementById('perfPeriod').value = perf.period;
                document.getElementById('perfDate').value = perf.date || new Date().toISOString().split('T')[0];
                document.getElementById('perfEvaluator').value = perf.evaluator || '';

                // Populate scores
                const details = perf.details || {};
                if (details.productivity) {
                    document.querySelector(`input[name="productivity"][value="${details.productivity}"]`).checked = true;
                    document.getElementById('productivityScore').textContent = details.productivity;
                }
                if (details.quality) {
                    document.querySelector(`input[name="quality"][value="${details.quality}"]`).checked = true;
                    document.getElementById('qualityScore').textContent = details.quality;
                }
                if (details.teamwork) {
                    document.querySelector(`input[name="teamwork"][value="${details.teamwork}"]`).checked = true;
                    document.getElementById('teamworkScore').textContent = details.teamwork;
                }
                if (details.discipline) {
                    document.querySelector(`input[name="discipline"][value="${details.discipline}"]`).checked = true;
                    document.getElementById('disciplineScore').textContent = details.discipline;
                }
                if (details.initiative) {
                    document.querySelector(`input[name="initiative"][value="${details.initiative}"]`).checked = true;
                    document.getElementById('initiativeScore').textContent = details.initiative;
                }

                // Populate feedback
                document.getElementById('productivityNotes').value = perf.productivityNotes || '';
                document.getElementById('qualityNotes').value = perf.qualityNotes || '';
                document.getElementById('teamworkNotes').value = perf.teamworkNotes || '';
                document.getElementById('disciplineNotes').value = perf.disciplineNotes || '';
                document.getElementById('initiativeNotes').value = perf.initiativeNotes || '';
                document.getElementById('strengths').value = perf.strengths || '';
                document.getElementById('improvements').value = perf.improvements || '';
                document.getElementById('developmentGoals').value = perf.developmentGoals || '';
                document.getElementById('additionalNotes').value = perf.additionalNotes || '';

                // Populate approvals
                document.getElementById('evaluatorApproval').checked = perf.evaluatorApproval || false;
                document.getElementById('employeeAcknowledgment').checked = perf.employeeAcknowledgment || false;
                document.getElementById('evaluatorSignature').value = perf.evaluatorSignature || '';
                document.getElementById('employeeSignature').value = perf.employeeSignature || '';

                // Calculate total score
                calculateTotalScore();

                // Set form data attribute for editing
                document.getElementById('performanceForm').setAttribute('data-edit-id', id);
            }
        };

        // Attendance functionality
        document.getElementById('employeeSelect').addEventListener('change', function() {
            const employeeId = this.value;
            const checkInBtn = document.getElementById('checkInBtn');
            const checkOutBtn = document.getElementById('checkOutBtn');
            const statusDiv = document.getElementById('attendanceStatus');

            if (employeeId) {
                const todayAttendance = attendance.find(att => att.employeeId == employeeId && att.date === today);
                if (todayAttendance && !todayAttendance.checkOut) {
                    checkInBtn.disabled = true;
                    checkOutBtn.disabled = false;
                    statusDiv.innerHTML = `Check-in: ${todayAttendance.checkIn} | Status: Hadir`;
                } else if (todayAttendance && todayAttendance.checkOut) {
                    checkInBtn.disabled = true;
                    checkOutBtn.disabled = true;
                    statusDiv.innerHTML = `Check-in: ${todayAttendance.checkIn} | Check-out: ${todayAttendance.checkOut} | Selesai`;
                } else {
                    checkInBtn.disabled = false;
                    checkOutBtn.disabled = true;
                    statusDiv.innerHTML = 'Belum check-in hari ini';
                }
            } else {
                checkInBtn.disabled = true;
                checkOutBtn.disabled = true;
                statusDiv.innerHTML = '';
            }
        });

        document.getElementById('checkInBtn').addEventListener('click', function() {
            const employeeId = document.getElementById('employeeSelect').value;
            if (!employeeId) return;

            const employee = employees.find(emp => emp.id == employeeId);
            const now = new Date();
            const time = now.toTimeString().slice(0, 5);

            const newAttendance = {
                id: Date.now(),
                employeeId: parseInt(employeeId),
                employeeName: employee.name,
                date: today,
                checkIn: time,
                checkOut: null,
                status: 'present'
            };

            attendance.push(newAttendance);
            document.getElementById('employeeSelect').dispatchEvent(new Event('change'));
            openAttendanceModal();
            showNotification(`Check-in berhasil! Selamat datang ${employee.name}`, 'success');
        });

        document.getElementById('checkOutBtn').addEventListener('click', function() {
            const employeeId = document.getElementById('employeeSelect').value;
            if (!employeeId) return;

            const employee = employees.find(emp => emp.id == employeeId);
            const now = new Date();
            const time = now.toTimeString().slice(0, 5);

            const todayAttendance = attendance.find(att => att.employeeId == employeeId && att.date === today);
            if (todayAttendance) {
                todayAttendance.checkOut = time;
            }

            document.getElementById('employeeSelect').dispatchEvent(new Event('change'));
            openAttendanceModal();
            showNotification(`Check-out berhasil! Sampai jumpa ${employee.name}`, 'success');
        });

        // Generate salary functionality
        document.getElementById('generateSalaryBtn').addEventListener('click', function() {
            const employee = employees[Math.floor(Math.random() * employees.length)];
            const deductions = employee.salary * 0.05; // 5% potongan
            const allowances = employee.salary * 0.1; // 10% tunjangan
            const netSalary = employee.salary + allowances - deductions;

            const newSalary = {
                id: Date.now(),
                employeeId: employee.id,
                employeeName: employee.name,
                period: 'Februari 2024',
                baseSalary: employee.salary,
                allowances: allowances,
                deductions: deductions,
                netSalary: netSalary
            };

            salaries.push(newSalary);
            openSalaryModal();
            showNotification(`Slip gaji ${employee.name} berhasil dibuat!`, 'success');
        });

        // Export salary PDF functionality
        document.getElementById('exportSalaryPDF').addEventListener('click', function() {
            if (salaries.length === 0) {
                alert('Tidak ada data gaji untuk diekspor');
                return;
            }

            // Create PDF with jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');

            // Header
            doc.setFontSize(16);
            doc.text('LAPORAN GAJI KARYAWAN', 105, 20, { align: 'center' });
            doc.setFontSize(12);
            doc.text('PT. MY-OFFICE INDONESIA', 105, 30, { align: 'center' });
            doc.text(`Periode: ${new Date().toLocaleDateString('id-ID')}`, 105, 40, { align: 'center' });

            // Table data
            const tableData = salaries.map((sal, index) => {
                const employee = employees.find(e => e.name === sal.employeeName);
                const deductions = sal.baseSalary * 0.05;
                return [
                    (index + 1).toString(),
                    employee?.nip || '-',
                    sal.employeeName,
                    employee?.department || '-',
                    `Rp ${sal.baseSalary.toLocaleString()}`,
                    `Rp ${sal.allowances.toLocaleString()}`,
                    `Rp ${deductions.toLocaleString()}`,
                    `Rp ${sal.netSalary.toLocaleString()}`
                ];
            });

            // Add table
            doc.autoTable({
                head: [['No', 'NIP', 'Nama', 'Departemen', 'Gaji Pokok', 'Tunjangan', 'Potongan', 'Gaji Bersih']],
                body: tableData,
                startY: 50,
                styles: {
                    fontSize: 8,
                    cellPadding: 2,
                },
                headStyles: {
                    fillColor: [59, 130, 246],
                    textColor: 255,
                    fontSize: 9,
                    fontStyle: 'bold',
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245],
                },
            });

            // Footer
            const pageHeight = doc.internal.pageSize.height;
            doc.setFontSize(8);
            doc.text(`Dicetak pada: ${new Date().toLocaleDateString('id-ID')} ${new Date().toLocaleTimeString('id-ID')}`, 20, pageHeight - 20);
            doc.text('MyOffice - Sistem HRD', 20, pageHeight - 10);

            // Save PDF
            doc.save(`laporan-gaji-${new Date().toISOString().split('T')[0]}.pdf`);
            showNotification('Laporan gaji berhasil diekspor ke PDF!', 'success');
        });

        // Export salary XLSX functionality
        document.getElementById('exportSalaryXLSX').addEventListener('click', function() {
            if (salaries.length === 0) {
                alert('Tidak ada data gaji untuk diekspor');
                return;
            }

            // Create Excel file with SheetJS
            const worksheetData = [
                ['LAPORAN GAJI KARYAWAN'],
                ['PT. MY-OFFICE INDONESIA'],
                [''],
                ['No', 'NIP', 'Nama', 'Departemen', 'Gaji Pokok', 'Tunjangan', 'Potongan', 'Gaji Bersih']
            ];

            salaries.forEach((sal, index) => {
                const employee = employees.find(e => e.name === sal.employeeName);
                const deductions = sal.baseSalary * 0.05;
                worksheetData.push([
                    index + 1,
                    employee?.nip || '-',
                    sal.employeeName,
                    employee?.department || '-',
                    sal.baseSalary,
                    sal.allowances,
                    deductions,
                    sal.netSalary
                ]);
            });

            // Add footer
            worksheetData.push(['']);
            worksheetData.push(['Dicetak pada:', new Date().toLocaleDateString('id-ID') + ' ' + new Date().toLocaleTimeString('id-ID')]);
            worksheetData.push(['MyOffice - Sistem HRD']);

            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);

            // Set column widths
            worksheet['!cols'] = [
                { wch: 5 },  // No
                { wch: 12 }, // NIP
                { wch: 20 }, // Nama
                { wch: 15 }, // Departemen
                { wch: 12 }, // Gaji Pokok
                { wch: 12 }, // Tunjangan
                { wch: 12 }, // Potongan
                { wch: 12 }  // Gaji Bersih
            ];

            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Laporan Gaji');

            // Save Excel file
            XLSX.writeFile(workbook, `laporan-gaji-${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('Data gaji berhasil diekspor ke Excel!', 'success');
        });

        // Add evaluation functionality
        document.getElementById('addEvaluationBtn').addEventListener('click', function() {
            document.getElementById('performanceFormTitle').textContent = 'Tambah Evaluasi Performansi Baru';
            document.getElementById('performanceForm').reset();
            document.getElementById('performanceForm').removeAttribute('data-edit-id');

            // Populate employee dropdown
            const employeeSelect = document.getElementById('perfEmployee');
            employeeSelect.innerHTML = '<option value="">Pilih Karyawan</option>';
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = `${emp.name} - ${emp.position}`;
                employeeSelect.appendChild(option);
            });

            // Set default date
            document.getElementById('perfDate').value = new Date().toISOString().split('T')[0];

            // Reset scores
            document.getElementById('productivityScore').textContent = '0';
            document.getElementById('qualityScore').textContent = '0';
            document.getElementById('teamworkScore').textContent = '0';
            document.getElementById('disciplineScore').textContent = '0';
            document.getElementById('initiativeScore').textContent = '0';
            document.getElementById('totalScore').textContent = '0';
            document.getElementById('performanceCategory').textContent = 'Belum Dinilai';
            document.getElementById('performanceCategory').className = 'px-3 py-1 text-sm font-semibold rounded-full bg-gray-100 text-gray-800';

            document.getElementById('performanceFormModal').classList.remove('hidden');
        });

        // Export performance PDF functionality
        document.getElementById('exportPerformancePDF').addEventListener('click', function() {
            if (performance.length === 0) {
                alert('Tidak ada data performansi untuk diekspor');
                return;
            }

            // Create PDF with jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');

            // Header
            doc.setFontSize(16);
            doc.text('LAPORAN EVALUASI PERFORMANSI KARYAWAN', 105, 20, { align: 'center' });
            doc.setFontSize(12);
            doc.text('PT. MY-OFFICE INDONESIA', 105, 30, { align: 'center' });
            doc.text(`Periode: ${new Date().toLocaleDateString('id-ID')}`, 105, 40, { align: 'center' });

            // Table data
            const tableData = performance.map((perf, index) => {
                const employee = employees.find(e => e.name === perf.employeeName);
                return [
                    (index + 1).toString(),
                    employee?.nip || '-',
                    perf.employeeName,
                    employee?.department || '-',
                    perf.period,
                    `${perf.totalScore}%`,
                    perf.category
                ];
            });

            // Add table
            doc.autoTable({
                head: [['No', 'NIP', 'Nama', 'Departemen', 'Periode', 'Skor Total', 'Kategori']],
                body: tableData,
                startY: 50,
                styles: {
                    fontSize: 8,
                    cellPadding: 2,
                },
                headStyles: {
                    fillColor: [59, 130, 246],
                    textColor: 255,
                    fontSize: 9,
                    fontStyle: 'bold',
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245],
                },
            });

            // Footer
            const pageHeight = doc.internal.pageSize.height;
            doc.setFontSize(8);
            doc.text(`Dicetak pada: ${new Date().toLocaleDateString('id-ID')} ${new Date().toLocaleTimeString('id-ID')}`, 20, pageHeight - 20);
            doc.text('MyOffice - Sistem HRD', 20, pageHeight - 10);

            // Save PDF
            doc.save(`laporan-performansi-${new Date().toISOString().split('T')[0]}.pdf`);
            showNotification('Laporan performansi berhasil diekspor ke PDF!', 'success');
        });

        // Export performance XLSX functionality
        document.getElementById('exportPerformanceXLSX').addEventListener('click', function() {
            if (performance.length === 0) {
                alert('Tidak ada data performansi untuk diekspor');
                return;
            }

            // Create Excel file with SheetJS
            const worksheetData = [
                ['LAPORAN EVALUASI PERFORMANSI KARYAWAN'],
                ['PT. MY-OFFICE INDONESIA'],
                [''],
                ['No', 'NIP', 'Nama', 'Departemen', 'Periode', 'Skor Total', 'Kategori', 'Produktivitas', 'Kualitas', 'Kerjasama', 'Kedisiplinan', 'Inisiatif']
            ];

            performance.forEach((perf, index) => {
                const employee = employees.find(e => e.name === perf.employeeName);
                const details = perf.details || {};
                worksheetData.push([
                    index + 1,
                    employee?.nip || '-',
                    perf.employeeName,
                    employee?.department || '-',
                    perf.period,
                    perf.totalScore,
                    perf.category,
                    details.productivity || 0,
                    details.quality || 0,
                    details.teamwork || 0,
                    details.discipline || 0,
                    details.initiative || 0
                ]);
            });

            // Add footer
            worksheetData.push(['']);
            worksheetData.push(['Dicetak pada:', new Date().toLocaleDateString('id-ID') + ' ' + new Date().toLocaleTimeString('id-ID')]);
            worksheetData.push(['MyOffice - Sistem HRD']);

            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);

            // Set column widths
            worksheet['!cols'] = [
                { wch: 5 },  // No
                { wch: 12 }, // NIP
                { wch: 20 }, // Nama
                { wch: 15 }, // Departemen
                { wch: 15 }, // Periode
                { wch: 10 }, // Skor Total
                { wch: 15 }, // Kategori
                { wch: 12 }, // Produktivitas
                { wch: 10 }, // Kualitas
                { wch: 12 }, // Kerjasama
                { wch: 12 }, // Kedisiplinan
                { wch: 12 }  // Inisiatif
            ];

            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Laporan Performansi');

            // Save Excel file
            XLSX.writeFile(workbook, `laporan-performansi-${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('Data performansi berhasil diekspor ke Excel!', 'success');
        });

        // Employee form functionality
        document.getElementById('addEmployeeBtn').addEventListener('click', function() {
            document.getElementById('employeeFormTitle').textContent = 'Tambah Karyawan Baru';
            document.getElementById('employeeForm').reset();
            document.getElementById('employeeForm').removeAttribute('data-edit-id');

            // Generate NIP automatically
            const lastEmployee = employees[employees.length - 1];
            const nextNip = lastEmployee ? (parseInt(lastEmployee.nip) + 1).toString() : '2024001';
            document.getElementById('empNip').value = nextNip;

            document.getElementById('employeeFormModal').classList.remove('hidden');
        });

        // Performance form functionality
        document.getElementById('perfEmployee').addEventListener('change', function() {
            const employeeId = this.value;
            if (employeeId) {
                const employee = employees.find(emp => emp.id == employeeId);
                if (employee) {
                    document.getElementById('perfNip').value = employee.nip || '';
                    document.getElementById('perfPosition').value = employee.position || '';
                    document.getElementById('perfDepartment').value = employee.department || '';
                }
            } else {
                document.getElementById('perfNip').value = '';
                document.getElementById('perfPosition').value = '';
                document.getElementById('perfDepartment').value = '';
            }
        });

        // Score calculation functionality
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const name = this.name;
                const value = parseInt(this.value);
                document.getElementById(`${name}Score`).textContent = value.toString();
                calculateTotalScore();
            });
        });

        function calculateTotalScore() {
            const productivity = parseInt(document.getElementById('productivityScore').textContent) || 0;
            const quality = parseInt(document.getElementById('qualityScore').textContent) || 0;
            const teamwork = parseInt(document.getElementById('teamworkScore').textContent) || 0;
            const discipline = parseInt(document.getElementById('disciplineScore').textContent) || 0;
            const initiative = parseInt(document.getElementById('initiativeScore').textContent) || 0;

            const totalScore = Math.round((productivity * 0.25) + (quality * 0.25) + (teamwork * 0.20) + (discipline * 0.15) + (initiative * 0.15));

            document.getElementById('totalScore').textContent = totalScore.toString();

            const categoryElement = document.getElementById('performanceCategory');
            let category = 'Belum Dinilai';
            let categoryClass = 'bg-gray-100 text-gray-800';

            if (totalScore >= 90) {
                category = 'Excellent';
                categoryClass = 'bg-green-100 text-green-800';
            } else if (totalScore >= 80) {
                category = 'Good';
                categoryClass = 'bg-blue-100 text-blue-800';
            } else if (totalScore >= 70) {
                category = 'Average';
                categoryClass = 'bg-yellow-100 text-yellow-800';
            } else if (totalScore > 0) {
                category = 'Needs Improvement';
                categoryClass = 'bg-red-100 text-red-800';
            }

            categoryElement.textContent = category;
            categoryElement.className = `px-3 py-1 text-sm font-semibold rounded-full ${categoryClass}`;
        }

        // Performance form submission
        document.getElementById('performanceForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const employeeId = document.getElementById('perfEmployee').value;
            const employee = employees.find(emp => emp.id == employeeId);

            if (!employee) {
                alert('Pilih karyawan terlebih dahulu!');
                return;
            }

            const formData = {
                id: this.getAttribute('data-edit-id') || Date.now(),
                employeeId: parseInt(employeeId),
                employeeName: employee.name,
                nip: document.getElementById('perfNip').value,
                position: document.getElementById('perfPosition').value,
                department: document.getElementById('perfDepartment').value,
                period: document.getElementById('perfPeriod').value,
                date: document.getElementById('perfDate').value,
                evaluator: document.getElementById('perfEvaluator').value,
                totalScore: parseInt(document.getElementById('totalScore').textContent),
                category: document.getElementById('performanceCategory').textContent,
                details: {
                    productivity: parseInt(document.getElementById('productivityScore').textContent),
                    quality: parseInt(document.getElementById('qualityScore').textContent),
                    teamwork: parseInt(document.getElementById('teamworkScore').textContent),
                    discipline: parseInt(document.getElementById('disciplineScore').textContent),
                    initiative: parseInt(document.getElementById('initiativeScore').textContent)
                },
                productivityNotes: document.getElementById('productivityNotes').value,
                qualityNotes: document.getElementById('qualityNotes').value,
                teamworkNotes: document.getElementById('teamworkNotes').value,
                disciplineNotes: document.getElementById('disciplineNotes').value,
                initiativeNotes: document.getElementById('initiativeNotes').value,
                strengths: document.getElementById('strengths').value,
                improvements: document.getElementById('improvements').value,
                developmentGoals: document.getElementById('developmentGoals').value,
                additionalNotes: document.getElementById('additionalNotes').value,
                evaluatorApproval: document.getElementById('evaluatorApproval').checked,
                employeeAcknowledgment: document.getElementById('employeeAcknowledgment').checked,
                evaluatorSignature: document.getElementById('evaluatorSignature').value,
                employeeSignature: document.getElementById('employeeSignature').value
            };

            const editId = this.getAttribute('data-edit-id');
            if (editId) {
                // Update existing evaluation
                const index = performance.findIndex(p => p.id == editId);
                if (index !== -1) {
                    performance[index] = formData;
                    showNotification('Evaluasi performansi berhasil diperbarui!', 'success');
                }
            } else {
                // Add new evaluation
                performance.push(formData);
                showNotification(`Evaluasi performansi ${employee.name} berhasil ditambahkan!`, 'success');
            }

            document.getElementById('performanceFormModal').classList.add('hidden');
            openPerformanceModal();
        });

        // Performance form modal controls
        document.getElementById('closePerformanceFormModal').addEventListener('click', () => {
            document.getElementById('performanceFormModal').classList.add('hidden');
        });

        document.getElementById('cancelPerformanceForm').addEventListener('click', () => {
            document.getElementById('performanceFormModal').classList.add('hidden');
        });

        document.getElementById('closeEmployeeFormModal').addEventListener('click', () => {
            document.getElementById('employeeFormModal').classList.add('hidden');
        });

        document.getElementById('cancelEmployeeForm').addEventListener('click', () => {
            document.getElementById('employeeFormModal').classList.add('hidden');
        });

        document.getElementById('employeeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = {
                nip: document.getElementById('empNip').value,
                name: document.getElementById('empName').value,
                email: document.getElementById('empEmail').value,
                position: document.getElementById('empPosition').value,
                department: document.getElementById('empDepartment').value,
                phone: document.getElementById('empPhone').value,
                address: document.getElementById('empAddress').value,
                birthDate: document.getElementById('empBirthDate').value,
                joinDate: document.getElementById('empJoinDate').value,
                bankAccount: document.getElementById('empBankAccount').value,
                bankName: document.getElementById('empBankName').value,
                npwp: document.getElementById('empNpwp').value,
                salary: parseInt(document.getElementById('empSalary').value),
                status: document.querySelector('input[name="empStatus"]:checked').value
            };

            const editId = this.getAttribute('data-edit-id');
            if (editId) {
                // Edit existing employee
                const index = employees.findIndex(emp => emp.id == editId);
                if (index !== -1) {
                    employees[index] = { ...employees[index], ...formData };
                    showNotification('Data karyawan berhasil diperbarui!', 'success');
                }
            } else {
                // Add new employee
                const newEmployee = {
                    id: Date.now(),
                    ...formData
                };
                employees.push(newEmployee);
                showNotification('Karyawan baru berhasil ditambahkan!', 'success');
            }

            document.getElementById('employeeFormModal').classList.add('hidden');
            openEmployeeModal();
        });

        // Search and filter functionality
        document.getElementById('searchEmployee').addEventListener('input', function() {
            openEmployeeModal();
        });

        document.getElementById('filterDepartment').addEventListener('change', function() {
            openEmployeeModal();
        });
    </script>
</body>
</html>